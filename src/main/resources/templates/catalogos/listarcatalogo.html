<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">

<head>
    <title>Catálogos</title>
</head>

<body>
<div layout:fragment="content">

    <!-- ENCABEZADO -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-semibold">
            <i class="fa-solid fa-list text-primary"></i> Catálogos
        </h2>
        <a th:href="@{/catalogos/nuevo}" class="btn btn-success">
            <i class="fa-solid fa-plus"></i> Nuevo Catálogo
        </a>
    </div>

    <!-- TABLA -->
    <div class="card shadow-sm">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover table-striped" id="tablaCatalogos">
                    <thead class="table-primary">
                    <tr>
                        <th>ID</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Estado</th>
                        <th class="text-center">Acciones</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="cat : ${catalogos}">
                        <td th:text="${cat.codigoCat}"></td>
                        <td th:text="${cat.tipoCat}"></td>
                        <td th:text="${cat.descripcionCat}"></td>
                        <td>
                            <span th:if="${cat.estadoCat == 1}" class="badge bg-success">
                                <i class="fa-solid fa-check"></i> ACTIVO
                            </span>
                            <span th:if="${cat.estadoCat == 0}" class="badge bg-danger">
                                <i class="fa-solid fa-ban"></i> INACTIVO
                            </span>
                        </td>
                        <td class="text-center">
                            <a th:href="@{/catalogos/editar/{id}(id=${cat.codigoCat})}"
                               class="btn btn-warning btn-sm me-1">
                                <i class="fa-solid fa-pen"></i>
                            </a>

                            <button type="button"
							        class="btn btn-danger btn-sm btn-eliminar"
							        th:data-id="${cat.codigoCat}">
							    <i class="fa-solid fa-trash"></i>
							</button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- SWEETALERT GUARDAR / EDITAR -->
    <script th:if="${swal_title}">
    Swal.fire({
        icon: '[[${swal_icon}]]',
        title: '[[${swal_title}]]',
        text: '[[${swal_text}]]',
        confirmButtonColor: '#0d6efd'
    });
</script>

    <!-- DATATABLE + ELIMINAR -->
   <script>
	$(document).ready(function () {
	
	    $('#tablaCatalogos').DataTable({
	        language: {
	            url: '//cdn.datatables.net/plug-ins/1.13.8/i18n/es-ES.json'
	        }
	    });
	
	    // BOTÓN ELIMINAR
	    $('.btn-eliminar').on('click', function () {
	        let id = $(this).data('id');
	
	        Swal.fire({
	            title: '¿Eliminar catálogo?',
	            text: 'Esta acción no se puede deshacer',
	            icon: 'warning',
	            showCancelButton: true,
	            confirmButtonColor: '#dc3545',
	            cancelButtonColor: '#6c757d',
	            confirmButtonText: 'Sí, eliminar',
	            cancelButtonText: 'Cancelar'
	        }).then((result) => {
	            if (result.isConfirmed) {
	                window.location.href = '/catalogos/eliminar/' + id;
	            }
	        });
	    });
	
	});
	</script>

</div>
</body>
</html>